<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (21) -->
<title>co.decodable.sdk.pipeline.testing (Decodable Pipeline SDK 1.19.2-1.0.0.Beta8)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: co.decodable.sdk.pipeline.testing">
<meta name="generator" content="javadoc/PackageWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.7.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="package-declaration-page">
<script type="text/javascript">var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span><span class="nav-bar-toggle-icon">&nbsp;</span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<div class="about-language">Copyright Â© 2023 - 2025 <a style="text-transform:none;" href="https://www.decodable.co">Decodable, Inc.</a>; Licensed under the Apache License, version 2.0.</div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li class="nav-bar-cell1-rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#package">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Package:</p>
<ul>
<li><a href="#package-description">Description</a></li>
<li><a href="#related-package-summary">Related Packages</a></li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Package:&nbsp;</li>
<li><a href="#package-description">Description</a>&nbsp;|&nbsp;</li>
<li><a href="#related-package-summary">Related Packages</a>&nbsp;|&nbsp;</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</div>
<div class="nav-list-search"><a href="../../../../../search.html">SEARCH</a>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<h1 title="Package co.decodable.sdk.pipeline.testing" class="title">Package co.decodable.sdk.pipeline.testing</h1>
</div>
<hr>
<div class="package-signature">package <span class="element-name">co.decodable.sdk.pipeline.testing</span></div>
<section class="package-description" id="package-description">
<div class="block">Infrastructure and utilities for (integration) testing custom Decodable pipelines.

 <p>Using a <a href="PipelineTestContext.html" title="class in co.decodable.sdk.pipeline.testing"><code>PipelineTestContext</code></a>, you can produce elements for one or more Decodable
 streams, run your custom pipeline, and assert the output elements of this pipeline on another
 Decodable stream. It is recommended to use <a href="https://testcontainers.com/">Testcontainers</a> for starting a Kafka or Redpanda broker to
 be used for testing, as shown below:

 <p>
<div class="snippet-container"><button class="copy snippet-copy" aria-label="Copy snippet" onclick="copySnippet(this)"><span data-copied="Copied!">Copy</span><img src="../../../../../copy.svg" alt="Copy snippet"></button>
<pre class="snippet"><code class="language-java">@Testcontainers
public class DataStreamJobTest {

  private static final String PURCHASE_ORDERS = "purchase-orders";
  private static final String PURCHASE_ORDERS_PROCESSED = "purchase-orders-processed";

  @Container
  public RedpandaContainer broker =
      new RedpandaContainer("docker.redpanda.com/redpandadata/redpanda:v23.1.2");

  @Test
  public void shouldUpperCaseCustomerName() throws Exception {
    TestEnvironment testEnvironment =
        TestEnvironment.builder()
            .withBootstrapServers(broker.getBootstrapServers())
            .withStreams(PURCHASE_ORDERS, PURCHASE_ORDERS_PROCESSED)
            .build();

    try (PipelineTestContext ctx = new PipelineTestContext(testEnvironment)) {
      String value =
          "{\n"
              + "  \"order_id\" : 19001,\n"
              + "  \"order_date\" : \"2023-06-09 10:18:38\",\n"
              + "  \"customer_name\" : \"Yolanda Hagenes\",\n"
              + "  \"price\" : 15.00,\n"
              + "  \"product_id\" : 108,\n"
              + "  \"order_status\" : false\n"
              + "}";
      String value2 =
          "{\n"
              + "  \"order_id\" : 19002,\n"
              + "  \"order_date\" : \"2023-06-09 11:25:33\",\n"
              + "  \"customer_name\" : \"Erwin Mausepeter\",\n"
              + "  \"price\" : 35.00,\n"
              + "  \"product_id\" : 22,\n"
              + "  \"order_status\" : false\n"
              + "}";

      // given
      ctx.stream(PURCHASE_ORDERS).add(new StreamRecord&lt;&gt;(value));
      ctx.stream(PURCHASE_ORDERS).add(new StreamRecord&lt;&gt;(value2));

      // when (as an example, PurchaseOrderProcessingJob upper-cases the customer name)
      ctx.runJobAsync(PurchaseOrderProcessingJob::main);

      StreamRecord&lt;String&gt; result =
          ctx.stream(PURCHASE_ORDERS_PROCESSED).takeOne().get(30, TimeUnit.SECONDS);
      StreamRecord&lt;String&gt; result2 =
          ctx.stream(PURCHASE_ORDERS_PROCESSED).takeOne().get(30, TimeUnit.SECONDS);
      ObjectNode purchaseOrder = (ObjectNode) new ObjectMapper().readTree(result.value());
      ObjectNode purchaseOrder2 = (ObjectNode) new ObjectMapper().readTree(result2.value());

      // then
      assertThat(purchaseOrder.get("customer_name").asText()).isEqualTo("YOLANDA HAGENES");
      assertThat(purchaseOrder2.get("customer_name").asText()).isEqualTo("ERWIN MAUSEPETER");
    }
  }
}
</code></pre>
</div>
</div>
</section>
<section class="summary">
<ul class="summary-list">
<li>
<div id="related-package-summary">
<div class="caption"><span>Related Packages</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Package</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color"><a href="../package-summary.html">co.decodable.sdk.pipeline</a></div>
<div class="col-last even-row-color">
<div class="block">An SDK for implementing Apache Flink jobs and running them on <a href="https://www.decodable.co">Decodable</a>.</div>
</div>
<div class="col-first odd-row-color"><a href="../exception/package-summary.html">co.decodable.sdk.pipeline.exception</a></div>
<div class="col-last odd-row-color">&nbsp;</div>
<div class="col-first even-row-color"><a href="../metadata/package-summary.html">co.decodable.sdk.pipeline.metadata</a></div>
<div class="col-last even-row-color">
<div class="block">Annotations for linking custom pipelines to managed Decodable streams.</div>
</div>
<div class="col-first odd-row-color"><a href="../util/package-summary.html">co.decodable.sdk.pipeline.util</a></div>
<div class="col-last odd-row-color">
<div class="block">Miscellaneous utilities.</div>
</div>
</div>
</div>
</li>
<li>
<div id="class-summary">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="class-summary-tab0" role="tab" aria-selected="true" aria-controls="class-summary.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary', 2)" class="active-table-tab">All Classes and Interfaces</button><button id="class-summary-tab1" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab1', 2)" class="table-tab">Interfaces</button><button id="class-summary-tab2" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab2', 2)" class="table-tab">Classes</button></div>
<div id="class-summary.tabpanel" role="tabpanel" aria-labelledby="class-summary-tab0">
<div class="summary-table two-column-summary">
<div class="table-header col-first">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="DecodableStream.html" title="interface in co.decodable.sdk.pipeline.testing">DecodableStream</a>&lt;T&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">Represents a data stream on the Decodable platform.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="PipelineTestContext.html" title="class in co.decodable.sdk.pipeline.testing">PipelineTestContext</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Provides access to Decodable streams during testing as well as the ability to run custom Flink
 jobs.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab1"><a href="PipelineTestContext.ThrowingConsumer.html" title="interface in co.decodable.sdk.pipeline.testing">PipelineTestContext.ThrowingConsumer</a>&lt;T&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab1">
<div class="block">A <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/function/Consumer.html" title="class or interface in java.util.function" class="external-link"><code>Consumer</code></a> variant which allows for declared checked exception types.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="StreamRecord.html" title="class in co.decodable.sdk.pipeline.testing">StreamRecord</a>&lt;T&gt;</div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Represents one element on a Decodable stream.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="TestEnvironment.html" title="class in co.decodable.sdk.pipeline.testing">TestEnvironment</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">An <a href="../EnvironmentAccess.Environment.html" title="interface in co.decodable.sdk.pipeline"><code>EnvironmentAccess.Environment</code></a> implementation for testing purposes, allowing to define one or more
 Decodable streams which then can be accessed from the job under test.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="TestEnvironment.Builder.html" title="class in co.decodable.sdk.pipeline.testing">TestEnvironment.Builder</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">A builder for creating new <a href="TestEnvironment.html" title="class in co.decodable.sdk.pipeline.testing"><code>TestEnvironment</code></a> instances.</div>
</div>
</div>
</div>
</div>
</li>
</ul>
</section>
</main>
</div>
</div>
</body>
</html>
